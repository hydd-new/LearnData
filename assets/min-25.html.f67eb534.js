import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,d as p}from"./app.e99e8fad.js";const t={},o=p(`<h3 id="\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u662F\u4EC0\u4E48</h3><p>Min_25 \u7B5B\u662F\u4E00\u79CD\u6C42\u79EF\u6027\u51FD\u6570\u524D\u7F00\u548C\u7684\u7B97\u6CD5\u3002</p><p>\u5177\u4F53\u6765\u8BF4\uFF0C\u5BF9\u4E8E\u4E00\u4E2A\u79EF\u6027\u51FD\u6570 $f$\uFF0C\u6C42\uFF1A</p><p>$$ ans=\\sum_{i=1}^n f(i) $$ \u9700\u8981\u5FEB\u901F\u8BA1\u7B97\u7D20\u6570\u7684\u5E42\u7684\u503C\u3002\u8BA1\u7B97\u7D20\u6570\u4E2A\u6570\u51FD\u6570 $\\pi(n)$ \u7684\u65F6\u95F4\u590D\u6742\u5EA6\u4E3A $O(\\dfrac{n^{\\frac{3}{4}}}{\\log n})$\uFF08\u5B83\u53EA\u7528\u5230\u7B2C\u4E00\u6B65\uFF09\uFF0C\u8BA1\u7B97\u5176\u5B83\u51FD\u6570\u65F6\u95F4\u590D\u6742\u5EA6\u4E3A $O(n^{1-\\epsilon})$\uFF08\u4E00\u822C\u80FD\u8DD1\u8FC7\u7684\u8303\u56F4\u5185\uFF0C\u4E5F\u53EF\u4EE5\u6309\u7167 $O(\\dfrac{n^{\\frac{3}{4}}}{\\log n})$ \u8BA1\u7B97\uFF09\u3002</p><h3 id="\u600E\u4E48\u505A" tabindex="-1"><a class="header-anchor" href="#\u600E\u4E48\u505A" aria-hidden="true">#</a> \u600E\u4E48\u505A</h3><h4 id="\u7B2C\u4E00\u6B65" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E00\u6B65" aria-hidden="true">#</a> \u7B2C\u4E00\u6B65</h4><p>\u601D\u8003\u4E0B\u9762\u8FD9\u4E2A\u95EE\u9898\uFF1A $$ G(n)=\\sum_{i=1}^n [i\\in \\mathbb P]f(i) $$ \u5176\u4E2D $\\mathbb P$ \u662F\u7D20\u6570\u96C6\u3002</p><p>\u8003\u8651\u6211\u4EEC\u662F\u600E\u4E48\u7B5B\u7D20\u6570\u7684\uFF0C\u6709\u4E00\u79CD\u65B9\u6CD5\u662F\u57C3\u6C0F\u7B5B\uFF0C\u5C31\u662F\u679A\u4E3E $p$\uFF0C\u7136\u540E\u5C06\u6700\u5C0F\u7D20\u56E0\u5B50\u662F $p$ \u7684\u5408\u6570\u7B5B\u53BB\u3002</p><p>\u5F53\u7136\uFF0C\u6211\u4EEC\u4E0D\u80FD\u76F4\u63A5\u50CF\u57C3\u6C0F\u7B5B\u4E00\u6837\u679A\u4E3E\u6700\u5C0F\u7D20\u56E0\u5B50\u662F $p$ \u7684\u5408\u6570\uFF0C\u8FD9\u6837\u8FD8\u4E0D\u5982\u76F4\u63A5\u66B4\u529B\u3002</p><p>\u5148\u627E\u5230\u5B8C\u5168\u79EF\u6027\u51FD\u6570 $f&#39;$ \u6EE1\u8DB3\u5BF9\u4E8E\u4EFB\u610F $x\\in \\mathbb P$\uFF0C$f&#39;(x)=f(x)$\uFF0C\u663E\u7136\u6EE1\u8DB3\u6761\u4EF6\u7684 $f&#39;$ \u53EA\u6709\u4E00\u4E2A\uFF08\u5B8C\u5168\u79EF\u6027\u51FD\u6570\u7531\u7D20\u6570\u4F4D\u7F6E\u7684\u70B9\u503C\u552F\u4E00\u786E\u5B9A\uFF09\u3002</p><p>\u8BBE $g(n,j)$ \u8868\u793A $2,3,\\cdots,n$ \u8FD9\u4E9B\u6570\u7ECF\u8FC7 $j$ \u8F6E\u57C3\u6C0F\u7B5B\uFF08\u5373\u7B5B\u4E86\u524D $j$ \u4E2A\u7D20\u6570\uFF09\u540E\uFF0C\u5269\u4E0B\u7684 $f&#39;$ \u7684\u503C\u548C\uFF0C$1$ \u6CA1\u6709\u8D21\u732E\uFF0C\u5219 $G(n)=g(n,|P|)$\u3002</p><p>\u5373 <u>$i$ \u662F\u8D28\u6570</u>\u6216\u8005 $i$ \u7684\u6700\u5C0F\u7D20\u56E0\u5B50\u5927\u4E8E $P_j$ \u7684 $f&#39;(i)$ \u4E4B\u548C\uFF0C\u5177\u4F53\u5730\uFF1A $$ g(n,j)=\\sum_{i=2}^n [i\\in \\mathbb P\\space \\operatorname{or}\\space \\operatorname{minp}(i)\\gt P_j]f&#39;(i) $$ \u5176\u4E2D $\\operatorname{minp}(i)$ \u8868\u793A $i$ \u7684\u6700\u5C0F\u7D20\u56E0\u5B50\uFF0C$P_j$ \u8868\u793A\u7B2C $j$ \u5C0F\u7684\u7D20\u6570\u3002</p><p>\u8003\u8651\u4F7F\u7528 $dp$ \u6765\u8BA1\u7B97 $g(n,j)$\uFF0C\u90A3\u4E48\u8981\u5728 $g(n,j-1)$ \u4E2D\u5269\u4E0B\u7684\u6570\u4E2D\u628A\u6700\u5C0F\u7D20\u56E0\u5B50\u662F $P_j$ \u7684\u5408\u6570\u7B5B\u53BB\u3002</p><p>$P_j^2$ \u4E3A\u6EE1\u8DB3\u6700\u5C0F\u7D20\u56E0\u5B50\u662F $P_j$ \u7684\u6700\u5C0F\u5408\u6570\uFF0C\u5206\u60C5\u51B5\u8BA8\u8BBA\uFF1A</p><ul><li>$P_j^2\\gt n$\uFF0C\u4E0D\u5B58\u5728\u6700\u5C0F\u7D20\u56E0\u5B50\u662F $P_j$ \u7684\u5408\u6570\uFF0C$g(n,j)=g(n,j-1)$\uFF1B</li><li>$P_j^2\\leq n$\uFF0C$f&#39;$ \u6EE1\u8DB3\u5B8C\u5168\u79EF\u6027\uFF0C\u4E14\u4F1A\u88AB\u7B5B\u6389\u7684\u6570\u4E3A $2,3,\\cdots,\\lfloor\\dfrac{n}{P_j}\\rfloor$ \u4E2D\u4EFB\u4F55\u6EE1\u8DB3 $\\operatorname{minp}(x)&gt;P_{j-1}$ \u7684\u6570 $x\\times P_j$\uFF0C$g(n,j)=g(n,j-1)-f&#39;(P_j)[g(\\lfloor\\dfrac{n}{P_j}\\rfloor,j-1)-g(P_j-1,j-1)]$\uFF08\u56E0\u4E3A $g(\\lfloor\\dfrac{n}{P_j}\\rfloor,j-1)$ \u4E2D\u8FD8\u8BA1\u7B97\u4E86 $2,3,\\cdots,p_j-1$ \u79CD\u7684\u7D20\u6570\u7684\u503C\u6240\u4EE5\u6263\u53BB\uFF09\u3002</li></ul><p>$g(P_j-1,j-1)$ \u53EF\u4EE5\u76F4\u63A5\u6C42\u51FA\uFF0C\u4E0D\u9700\u8981\u5355\u72EC\u8BA1\u7B97\uFF08$P_j^2\\leq n$\uFF0C\u5C31\u662F\u4E00\u4E2A\u7D20\u6570\u4F4D\u7F6E\u7684\u503C\u7684\u524D\u7F00\u548C\uFF09\u3002</p><p>\u7531\u4E8E $g$ \u7684\u7B2C\u4E00\u7EF4\u662F\u6BCF\u6B21\u662F\u9664\u4E00\u4E2A\u6570\u4E0B\u53D6\u6574\uFF0C\u800C $\\lfloor\\dfrac{\\lfloor\\frac{n}{a}\\rfloor}{b}\\rfloor=\\lfloor\\dfrac{n}{ab}\\rfloor$\uFF0C\u6240\u4EE5\u7B2C\u4E00\u7EF4\u53EF\u4EE5\u53EA\u8BB0\u5F55\u5F62\u5982 $\\lfloor\\dfrac{n}{x}\\rfloor$ \u7684\u503C\u3002</p><h4 id="\u7B2C\u4E8C\u6B65" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E8C\u6B65" aria-hidden="true">#</a> \u7B2C\u4E8C\u6B65</h4><p>\u6C42\u51FA\u4E86 $G$ \u4E4B\u540E\u5982\u4F55\u8BA1\u7B97\u7B54\u6848\u3002</p><p>\u7C7B\u4F3C\u5730\uFF0C\u8BBE $S(n,j)$ \u8868\u793A $2,3,\\cdots,n$ \u8FD9\u4E9B\u6570\u4E2D\uFF0C$i$ \u7684\u6700\u5C0F\u7D20\u56E0\u5B50\u5927\u4E8E $P_j$ \u7684 $f(i)$ \u4E4B\u548C\uFF0C\u5C06 $1$ \u7684\u8D21\u732E\u5355\u72EC\u7B97\uFF0C\u5219 $ans=S(n,1)$\u3002</p><p>\u5177\u4F53\u5730\uFF1A $$ S(n,j)=\\sum_{i=2}^n[\\operatorname{minp}(i)\\gt P_j]f(i) $$</p><p>\u8003\u8651\u4ECD\u7136\u4F7F\u7528 $dp$ \u8BA1\u7B97\uFF0C $$ S(n,j)=G(n)-\\sum_{i=1}^{j-1}f(P_i)+\\sum_{k\\ge j}\\sum_{e\\geq 1,P_k^e\\leq n}f(P_k^e)(S(\\lfloor\\frac{n}{P_k^e}\\rfloor,k+1)+[e\\gt 1]) $$</p><h3 id="\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#\u5E94\u7528" aria-hidden="true">#</a> \u5E94\u7528</h3><h4 id="\u8BA1\u7B97\u7D20\u6570\u4E2A\u6570\u51FD\u6570-pi-n" tabindex="-1"><a class="header-anchor" href="#\u8BA1\u7B97\u7D20\u6570\u4E2A\u6570\u51FD\u6570-pi-n" aria-hidden="true">#</a> \u8BA1\u7B97\u7D20\u6570\u4E2A\u6570\u51FD\u6570 $\\pi(n)$</h4><p>\u53EA\u9700\u8981\u7528\u5230\u7B2C\u4E00\u6B65\uFF0C$f$ \u51FD\u6570\u6EE1\u8DB3\u7D20\u6570\u4F4D\u7F6E\u7684\u503C\u4E3A $1$\u3002</p><p>\u76F4\u63A5\u6309\u7167\u7B2C\u4E00\u6B65\u7684\u6B65\u9AA4\u505A\u5373\u53EF\u3002</p><div class="language-cpp ext-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> ll<span class="token punctuation">;</span>
ll n<span class="token punctuation">,</span>l<span class="token punctuation">,</span>g<span class="token punctuation">[</span><span class="token number">2100000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> tot<span class="token punctuation">,</span>p<span class="token punctuation">[</span><span class="token number">2100000</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">bool</span> vis<span class="token punctuation">[</span><span class="token number">2100000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cnt<span class="token punctuation">,</span>pos1<span class="token punctuation">[</span><span class="token number">2100000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>pos2<span class="token punctuation">[</span><span class="token number">2100000</span><span class="token punctuation">]</span><span class="token punctuation">;</span> ll num<span class="token punctuation">[</span><span class="token number">2100000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">Sieve</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    vis<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> p<span class="token punctuation">[</span><span class="token operator">++</span>tot<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>tot<span class="token operator">&amp;&amp;</span>i<span class="token operator">*</span>p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            vis<span class="token punctuation">[</span>i<span class="token operator">*</span>p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>i<span class="token operator">%</span>p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> x<span class="token operator">&lt;=</span>l<span class="token operator">?</span>pos1<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">:</span>pos2<span class="token punctuation">[</span>n<span class="token operator">/</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">upd</span><span class="token punctuation">(</span>ll x<span class="token punctuation">)</span><span class="token punctuation">{</span>
    num<span class="token punctuation">[</span><span class="token operator">++</span>cnt<span class="token punctuation">]</span><span class="token operator">=</span>x<span class="token punctuation">;</span> g<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token operator">=</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token operator">&lt;=</span>l<span class="token punctuation">)</span> pos1<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">=</span>cnt<span class="token punctuation">;</span>
    <span class="token keyword">else</span> pos2<span class="token punctuation">[</span>n<span class="token operator">/</span>x<span class="token punctuation">]</span><span class="token operator">=</span>cnt<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">&quot;%lld&quot;</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> l<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>l<span class="token operator">*</span>l<span class="token operator">&lt;=</span>n<span class="token punctuation">)</span> l<span class="token operator">++</span><span class="token punctuation">;</span>
    l<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token function">Sieve</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>ll i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">=</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        j<span class="token operator">=</span>n<span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token operator">/</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">upd</span><span class="token punctuation">(</span>n<span class="token operator">/</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>tot<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token number">1ll</span><span class="token operator">*</span>p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">*</span>p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;=</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
            g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-=</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span><span class="token function">calc</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span>p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lld\\n&quot;</span><span class="token punctuation">,</span>g<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,27),e=[o];function c(l,u){return s(),a("div",null,e)}var r=n(t,[["render",c],["__file","min-25.html.vue"]]);export{r as default};
